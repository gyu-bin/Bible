<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>

    <title>2025 나의 말씀뽑기</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dongle:wght@400;700&display=swap" rel="stylesheet">
    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="2025 내게 주신 하나님의 말씀">
    <meta property="og:description" content="지인들과 함께 내게 주신 말씀을 나눠보세요">
    <meta property="og:image" content="https://gyu-bin.github.io/Bible/love.png"> <!-- 업로드된 이미지 URL -->
    <meta property="og:url" content="https://gyu-bin.github.io/Bible/">
    <meta property="og:site_name" content="2025 나의 말씀뽑기">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="2025 내게 주신 하나님의 말씀">
    <meta name="twitter:description" content="지인들과 함께 내게 주신 말씀을 나눠보세요">
    <meta name="twitter:image" content="https://gyu-bin.github.io/Bible/love.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        body {
            margin: 0;
            font-family: "Dongle", serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background: linear-gradient(to bottom, #fdf1f1, #ffe6e6);
            color: #333;
            min-height: 100vh; /* 최소 높이 설정 */
            text-align: center;
            box-sizing: border-box;
            padding: 10px; /* 추가 패딩 */
            overflow: hidden; /* 화면 넘침 방지 */
        }

        .container {
            text-align: center;
            max-width: 90%; /* 컨테이너 크기 제한 */
        }
        h1 {
            font-size: 70px; !important;
            font-weight: bold;
            color: #b63e3e;
            margin: 0;
            font-style: normal;
        }

        h2 {
            font-size: 25px !important;
            font-weight: 400;
            color: #b63e3e;
            background-color: #fff;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }
        .imageContainer {
            position: relative;
            top: 50px;
            /*width: 300px; !* 이미지 컨테이너 크기 *!*/
        }

        .imageContainer .bible {
            z-index: 1;
            width: 300px; /* 성경 이미지 크기 */
        }

        .verse-box {
            padding: 40px 30px;
            max-width: 90%;
            margin: 20px auto;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .verse-box.show {
            opacity: 1;
        }
        .verse {
            font-weight: bold;
            color: #6e4f3a;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            font-size: 2rem; !important;
        }
        .reference {
            margin-top: 15px;
            font-size: 1.2rem;
            color: #8c6f54;
        }
        button {
            background: linear-gradient(to right, #ff5252, #ff7979);
            color: white;
            font-size: 30px; !important;
            font-weight: bold;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.3);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
        }
        .progress-container {
            margin-top: 20px;
            position: relative;
            width: 80%;
            height: 10px;
            background: #f3e6d6;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px auto;
            display: none; /* 처음에는 숨김 */
        }
        .progress-bar {
            position: absolute;
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #ff6f61, #ff8a65);
        }
        .loading-text {
            font-size: 2rem; !important;
            color: #8c6f54;
            margin-top: 10px;
            display: none; /* 처음에는 숨김 */
        }
        #downloadButton{
            display: none;
        }
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem; /* 제목 크기 축소 */
            }
            h2 {
                font-size: 1rem; /* 부제목 크기 축소 */
            }
            .verse {
                font-size: 1.4rem; /* 말씀 크기 조정 */
            }
            .reference {
                font-size: 0.9rem; /* 참조 크기 조정 */
            }
            button {
                padding: 10px 18px; /* 버튼 크기 조정 */
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            h2 {
                font-size: 0.9rem;
            }
            .verse-box {
                padding: 15px; /* 모바일 여백 추가 */
                margin: 10px auto; /* 간격 조정 */
            }
            .verse {
                font-size: 1.2rem;
            }
            .reference {
                font-size: 0.8rem;
            }
            button {
                padding: 8px 16px;
                font-size: 0.9rem; /* 버튼 글꼴 크기 조정 */
            }
        }
    </style>
</head>
<body>
<div class="container">
    <h1 id="h1">2025 내게 주신 하나님의 말씀</h1>
    <h2 id="h2">지인들과 함께 내게 주신 말씀을 나눠보세요</h2>
    <div class="imageContainer">
        <img src="https://gyu-bin.github.io/Bible/heartandbible.png" alt="Bible" class="bible">
    </div>
    <div class="verse-box" id="verseBox">
        <p class="verse" id="verse">"너희는 세상의 빛이라"</p>
        <p class="reference" id="reference">마태복음 5:14</p>
    </div>
    <div class="progress-container" id="progressContainer">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    <p class="loading-text" id="loadingText">말씀을 뽑고 있습니다...</p>
    <button id="verseButton">말씀 뽑기</button>

    <button id="downloadButton">이미지 다운로드(구현중)</button>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script type="module">
    import { verses } from './verses.js';

    document.addEventListener("DOMContentLoaded", () => {
        console.log("DOMContentLoaded 이벤트 실행됨");

        const verseButton = document.getElementById("verseButton");
        const verseBox = document.getElementById("verseBox");
        const verseText = document.getElementById("verse");
        const referenceText = document.getElementById("reference");
        const progressBar = document.getElementById("progressBar");
        const progressContainer = document.getElementById("progressContainer");
        const loadingText = document.getElementById("loadingText");
        const download = document.getElementById('downloadButton')

        // 카카오톡 공유 버튼 생성
        const kakaoButton = document.createElement('button');
        const kakaoIcon = document.createElement('img');

        kakaoIcon.src = 'https://developers.kakao.com/assets/img/about/logos/kakaolink/kakaolink_btn_medium.png'; // 카카오톡 아이콘 URL
        kakaoIcon.alt = '카카오톡 공유';
        kakaoIcon.style.width = '40px'; // 아이콘 크기 조정
        kakaoIcon.style.height = '40px';
        kakaoIcon.style.display = 'block'; // 중앙 정렬
        kakaoIcon.style.margin = 'auto';

        kakaoButton.style.margin = '20px auto';
        kakaoButton.style.display = 'block';
        kakaoButton.style.padding = '10px'; // 여백 추가
        kakaoButton.style.background = 'transparent'; // 배경 제거
        kakaoButton.style.border = 'none'; // 버튼 테두리 제거
        kakaoButton.style.cursor = 'pointer';
        kakaoButton.style.display = 'none'; // 처음에는 숨김
        kakaoButton.style.fontFamily = "Dongle"
        kakaoButton.id = 'shareButton';

        kakaoButton.appendChild(kakaoIcon);
        // 클릭 이벤트 추가
        kakaoButton.addEventListener('click', shareToKakao);
        // 카카오톡 공유 버튼을 DOM에 추가 (디자인을 위해 아래로 배치)
        document.querySelector('.container').appendChild(kakaoButton);

        if (!verseButton || !verseBox || !verseText || !referenceText || !progressBar || !loadingText || !progressContainer) {
            console.error("필수 요소를 찾을 수 없습니다!");
            return;
        }

        // 말씀 목록


        verseButton.addEventListener("click", () => {
            console.log("버튼 클릭 이벤트 실행1");

            const imageContainer = document.querySelector('.imageContainer');
            if (imageContainer) {
                imageContainer.style.display = "none";
            }

            // 버튼 텍스트 변경
            verseButton.innerText = "다시 뽑기";
            verseButton.style.fontFamily =  "Dongle";
            verseButton.style.fontSize = '1.5rem'

            // 로딩 텍스트 및 게이지 바 활성화
            loadingText.style.display = "block";
            progressContainer.style.display = "block";
            progressBar.style.width = "0%";

            // 게이지 바 애니메이션 시작
            setTimeout(() => {
                progressBar.style.transition = "width 5s linear";
                progressBar.style.width = "100%";
            }, 10);

            // 5초 후 랜덤 말씀 표시 및 공유 버튼 활성화
            setTimeout(() => {
                const randomIndex = Math.floor(Math.random() * verses.length);
                const selectedVerse = verses[randomIndex];

                // 말씀과 참조 업데이트
                verseText.innerText = `"${selectedVerse.verse}"`;
                referenceText.innerText = selectedVerse.reference;

                // 로딩 텍스트 숨김 및 말씀 표시
                loadingText.style.display = "none";
                progressContainer.style.display = "none";
                progressBar.style.width = "0%";
                verseBox.classList.add("show");

                // 카카오톡 공유 버튼 표시
                kakaoButton.style.display = "block";
                download.style.display = "block"
                download.style.margin = "20px auto"; // 다운로드 버튼 가운데 정렬
                download.style.textAlign = "center"; // 텍스트 정렬 보장
                download.style.fontFamily =  "Dongle";
                download.style.fontSize = '1.5rem'

                console.log("선택된 말씀:", selectedVerse);
            }, 5000); // 5초 딜레이
        });

        document.getElementById("downloadButton").addEventListener("click", () => {
            const resultContainer = document.getElementById("verseBox");

            if (resultContainer) {
                html2canvas(resultContainer).then(canvas => {
                    canvas.toBlob(blob => {
                        if (blob) {
                            const url = URL.createObjectURL(blob);
                            const link = document.createElement("a");
                            link.href = url;
                            link.download = "bible-result.png";

                            if (typeof link.click === "function") {
                                link.click();
                            } else {
                                // iOS Safari 대안
                                window.open(url, "_blank");
                            }

                            URL.revokeObjectURL(url);
                        } else {
                            console.error("Blob 변환 중 오류 발생.");
                        }
                    });
                }).catch(err => {
                    console.error("이미지 저장 중 오류 발생:", err);
                });
            } else {
                console.error("요소 #resultContainer를 찾을 수 없습니다.");
            }
        });


        // 카카오 초기화
        Kakao.init('0288684a26b770807358f1c5e855b1c1');
        // 카카오톡 공유 기능
        function shareToKakao() {
            document.getElementById("shareButton").addEventListener("click", () => {
                Kakao.Link.sendCustom({
                    templateId: 115764, // 생성한 템플릿 ID
                    templateArgs: {
                        // 동적으로 전달할 데이터 (템플릿 설정에서 정의한 값들)
                        title: '2025 내게 주신 하나님의 말씀', // 템플릿에 전달할 title
                        description: `제가 뽑은 말씀은 ${verse.innerText} (${reference.innerText}) 이에요!`,
                    }
                });
            });
        }
    });
</script>
</body>
</html>
<!--인스타연동-->
