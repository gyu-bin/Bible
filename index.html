<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>

    <title>2025 나의 말씀뽑기</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ultra&display=swap" rel="stylesheet">
    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="2025 내게 주신 하나님의 말씀">
    <meta property="og:description" content="지인들과 함께 내게 주신 말씀을 나눠보세요">
    <meta property="og:image" content="https://gyu-bin.github.io/Bible/love.png"> <!-- 업로드된 이미지 URL -->
    <meta property="og:url" content="https://gyu-bin.github.io/Bible/">
    <meta property="og:site_name" content="2025 나의 말씀뽑기">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="2025 내게 주신 하나님의 말씀">
    <meta name="twitter:description" content="지인들과 함께 내게 주신 말씀을 나눠보세요">
    <meta name="twitter:image" content="https://gyu-bin.github.io/Bible/love.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: "Pretendard", -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(to bottom, #fdf1f1, #ffe6e6);
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-sizing: border-box; /* 패딩 포함 크기 계산 */
            overflow: hidden; /* 스크롤 방지 */
        }

        .container {
            width: 100%;
            height: 100%; /* 화면에 꽉 차도록 설정 */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-top: -25px;
            box-sizing: border-box;
            padding: 20px; /* 내부 여백 */
        }

        /* 제목 스타일 */
        h1 {
            font-size: 5rem; /* 제목 크기를 키워 강조 */
            font-weight: 800; /* 조금 더 두껍게 */
            margin-bottom: -10px; /* 제목과 부제목 간격 조정 */
            font-family: "Ultra", serif;
            /*            background: linear-gradient(to right, #ff5252, #ff7979);*/
            /* 텍스트 그라데이션 */
            background: linear-gradient(to right, #ff5252, #ff7979); /* 그라데이션 색상 */
            -webkit-background-clip: text; /* 텍스트에 배경 클리핑 */
            -webkit-text-fill-color: transparent; /* 텍스트 채우기 투명 */
            background-clip: text; /* 텍스트에 배경 클리핑 */
            text-fill-color: transparent; /* 텍스트 채우기 투명 */
        }

        h2 {
            font-size: 1.5rem; /* 텍스트 크기 */
            font-weight: 600; /* 텍스트 굵기 */
            color: #b63e3e; /* 텍스트 색상 */
            background-color: #ffffff; /* 배경색 흰색 */
            padding: 10px 20px; /* 텍스트 내부 여백 */
            border-radius: 50px; /* 둥근 모서리 */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 부드러운 그림자 */
            display: inline-block; /* 내용에 맞게 크기 조정 */
            margin-top: 10px; /* 위아래 간격 */
        }

        h3 {
            font-size: 1rem; /* 부제목 크기 축소 */
            font-weight: 500; /* 조금 얇게 조정 */
            margin-top: 20px; /* 위아래 간격 조정 */
            color: #805C5C;
        }

        /* 이미지 스타일 */
        .imageContainer {
            width: 70%; /* 이미지 크기를 줄임 */
            max-width: 350px; /* 최대 크기 제한 */
            margin-top: 15px; /* 이미지와 제목 사이 간격 */
        }

        .imageContainer .bible {
            width: 100%; /* 컨테이너에 맞게 크기 조정 */
        }

        /* 말씀 박스 */
        .verse-box {
            display: none; /* 처음에는 숨김 */
            padding: 30px 40px; /* 내부 여백 */
            max-width: 600px; /* 최대 너비 */
            margin: 20px auto; /* 가운데 정렬 */
            background: #ffffff; /* 흰색 배경 */
            border-radius: 20px; /* 둥근 모서리 */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(255, 182, 193, 0.4); /* 그림자 추가 */
            border: 3px solid rgba(255, 223, 223, 0.7); /* 부드러운 테두리 */
        }

        .verse {
            font-size: 1.8rem; /* 말씀 텍스트 크기 */
            font-weight: 600; /* 굵은 텍스트 */
            color: #6e4f3a; /* 텍스트 색상 */
            text-align: center; /* 가운데 정렬 */
            margin-bottom: 15px; /* 하단 간격 */
            word-break: keep-all; /* 단어가 어색하게 잘리지 않도록 설정 */
            white-space: pre-wrap; /* 줄바꿈을 자연스럽게 처리 */
        }

        .reference {
            font-size: 1rem; /* 작은 텍스트 */
            font-weight: 400; /* 보통 굵기 */
            color: #8c6f54; /* 색상 */
            text-align: center; /* 가운데 정렬 */
        }

        button {
            /*background: linear-gradient(to right, #F57272, #AB3240); !* 더 부드러운 그라디언트 *!*/
            background: linear-gradient(to right, #ff5252, #ff7979);
            color: white;
            font-size: 20px; /* 버튼 텍스트 크기 감소 */
            font-weight: 600;
            padding: 18px 80px; /* 버튼 크기 확대 */
            border: none;
            border-radius: 40px;
            cursor: pointer;
            /*box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.2);*/
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-3px);
            /*box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.3);*/
        }

        button:active {
            transform: translateY(0);
            /*box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);*/
        }

        .progress-container {
            margin-top: 20px;
            position: relative;
            width: 80%;
            height: 10px;
            background: #f3e6d6;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px auto;
            display: none; /* 처음에는 숨김 */
        }
        .progress-bar {
            position: absolute;
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #ff6f61, #ff8a65);
        }

        @keyframes bounce-in-top{0%{transform:translateY(-500px);animation-timing-function:ease-in;opacity:0}38%{transform:translateY(0);animation-timing-function:ease-out;opacity:1}55%{transform:translateY(-65px);animation-timing-function:ease-in}72%{transform:translateY(0);animation-timing-function:ease-out}81%{transform:translateY(-28px);animation-timing-function:ease-in}90%{transform:translateY(0);animation-timing-function:ease-out}95%{transform:translateY(-8px);animation-timing-function:ease-in}100%{transform:translateY(0);animation-timing-function:ease-out}}

        /* 글자의 움직임 애니메이션 */
        @keyframes wave {
            0% {
                transform: translateY(0);
                opacity: 1; /* 애니메이션 시작 시 보이기 */
            }
            50% {
                transform: translateY(-10px);
            }
            100% {
                transform: translateY(0);
            }
        }

        /* 각 글자마다 딜레이 추가 */
        .loading-letter:nth-child(1) {
            animation-delay: 0s;
        }

        .loading-letter:nth-child(2) {
            animation-delay: 0.1s;
        }

        .loading-letter:nth-child(3) {
            animation-delay: 0.2s;
        }

        .loading-letter:nth-child(4) {
            animation-delay: 0.3s;
        }

        .loading-letter:nth-child(5) {
            animation-delay: 0.4s;
        }

        .loading-letter:nth-child(6) {
            animation-delay: 0.5s;
        }

        .loading-letter:nth-child(7) {
            animation-delay: 0.6s;
        }

        .loading-letter:nth-child(8) {
            animation-delay: 0.7s;
        }

        .loading-letter:nth-child(9) {
            animation-delay: 0.8s;
        }

        .loading-letter:nth-child(10) {
            animation-delay: 0.9s;
        }

        .loading-letter:nth-child(11) {
            animation-delay: 1s;
        }

        .loading-letter:nth-child(12) {
            animation-delay: 1.1s;
        }

        .loadingText {
            display: none;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
            gap: 5px;
            padding: 0 20px; /* 좌우 여백 추가 */
        }
        /*.loadingText.active {
            display: flex; !important;
        }*/
        .loading-letter {
            font-size: 2rem;
            font-weight: bold;
            color: #8c6f54;
            animation: wave 1.2s infinite ease-in-out;
            transform-origin: center; /* 애니메이션 기준 설정 */
        }

        #btnContainer{
            display: flex; /* 가로 정렬 */
            justify-content: center; /* 중앙 정렬 */
        }
        #kakaoButton {
            margin: 20px auto;
            display: none;
            padding: 10px; /* 여백 추가 */
            background: transparent; /* 배경 제거 */
            border: none; /* 버튼 테두리 제거 */
            cursor: pointer; /* 클릭 커서 */
        }

        #kakaoIcon {
            width: 40px; /* 아이콘 크기 */
            height: 40px;
            display: block; /* 중앙 정렬 */
            margin: auto;
            box-shadow: none; /* 박스 쉐도우 제거 */
        }

        #downloadButton{
            display: none;
            font-size: 10px;
            /*background: linear-gradient(to right, #F57272, #ff7979); !* 뽑기 버튼과 동일한 그라데이션 *!
            color: white;
            font-size: 20px; !* 버튼 텍스트 크기 *!
            font-weight: 600;
            padding: 18px 80px; !* 버튼 크기 *!
            border: none;
            border-radius: 40px;
            cursor: pointer;
            transition: all 0.3s ease;*/
        }
        #downloadButton:hover {
            transform: translateY(-3px);
        }

        #downloadButton:active {
            transform: translateY(0);
        }

        /* 반응형 스타일 */
        @media (max-width: 768px) {
            h1 {
                font-size: 5.5rem; /* 조금 더 커진 폰트 */
                margin-bottom: -10px; /* 간격 추가 */
                font-weight: 800;
            }
            h2 {
                font-size: 1.4rem; /* 부드러운 가독성을 위한 크기 조정 */
                padding: 10px 20px; /* 여백 조정 */
            }
            .verse-box {
                padding: 20px; /* 간격 줄이기 */
                margin: 15px; /* 상하 좌우 여백 축소 */
            }
            .verse {
                font-size: 1.6rem; /* 말씀 크기 약간 증가 */
            }
            .reference {
                font-size: 1rem; /* 크기 조금 증가 */
            }
            button {
                padding: 18px 80px; /* 버튼 여백 조정 */
                font-size: 20px; /* 버튼 글씨 크기 증가 */
            }
            .loadingText {
                margin: 0 auto; /* 중앙 정렬 */
                padding: 0 20px; /* 중간 화면 좌우 여백 */
                width: 90%; /* 화면 너비 조정 */
                max-width: 500px; /* 최대 너비 */
            }
            .loading-letter {
                font-size: 1.2rem; /* 글자 크기 더 축소 */
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 4.5rem; /* 더 작은 화면에서 가독성을 유지 */
                margin-bottom: -10px;
                font-weight: 800;
            }
            h2 {
                font-size: 1.2rem; /* 부드러운 가독성을 위한 조정 */
                padding: 10px 20px; /* 여백 조정 */
            }
            .verse-box {
                padding: 20px; /* 간격 줄이기 */
                margin: 15px; /* 상하 좌우 여백 축소 */
            }
            .verse {
                font-size: 1.3rem; /* 가독성을 위한 약간 증가 */
            }
            .reference {
                font-size: 0.85rem; /* 참조 크기 조정 */
            }
            button {
                padding: 18px 80px; /* 버튼 여백 조정 */
                font-size: 16px; /* 글씨 크기 유지 */
            }
            .loadingText {
                margin: 0 auto; /* 중앙 정렬 */
                padding: 0 15px; /* 작은 화면 좌우 여백 */
                width: 90%; /* 화면 너비 조정 */
                max-width: 400px; /* 최대 너비 */
            }
            .loading-letter {
                font-size: 1rem; /* 글자 크기 더 축소 */
            }
        }

    </style>
</head>
<body>
<div class="container">
    <h1>2025</h1>
    <h2>내게 주신 하나님의 말씀</h2>
    <div class="imageContainer">
        <img src="https://gyu-bin.github.io/Bible/heartandbible.png" alt="Bible" class="bible">
    </div>
    <div class="verse-box" id="verseBox">
        <p class="verse" id="verse">"너희는 세상의 빛이라"</p>
        <p class="reference" id="reference">마태복음 5:14</p>
    </div>
    <div class="progress-container" id="progressContainer">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="loadingText" id="loadingText">
        <span class="loading-letter">말</span>
        <span class="loading-letter">씀</span>
        <span class="loading-letter">을</span>
        <span class="loading-letter"> </span>
        <span class="loading-letter">뽑</span>
        <span class="loading-letter">고</span>
        <span class="loading-letter"> </span>
        <span class="loading-letter">있</span>
        <span class="loading-letter">습</span>
        <span class="loading-letter">니</span>
        <span class="loading-letter">다</span>
        <span class="loading-letter">.</span>
        <span class="loading-letter">.</span>
        <span class="loading-letter">.</span>
    </div>

    <h3 id="shareMent">사랑하는 사람들과 함께 <br> 내게 주신 말씀을 나눠보세요</h3>
    <button id="verseButton">말씀 뽑기</button>

    <div id="btnContainer">
        <button id="kakaoButton">
            <img src="https://developers.kakao.com/assets/img/about/logos/kakaolink/kakaolink_btn_medium.png" alt="카카오톡 공유" id="kakaoIcon">
        </button>
        <button id="downloadButton">이미지 다운로드</button>
    </div>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script type="module">
    import { verses } from './verses.js';

    document.addEventListener("DOMContentLoaded", () => {
        console.log("DOMContentLoaded 이벤트 실행됨");

        const verseButton = document.getElementById("verseButton");
        const verseBox = document.getElementById("verseBox");
        const verseText = document.getElementById("verse");
        const referenceText = document.getElementById("reference");
        const progressBar = document.getElementById("progressBar");
        const progressContainer = document.getElementById("progressContainer");
        const loadingText = document.getElementById("loadingText");
        const download = document.getElementById('downloadButton')
        const shareMent = document.getElementById('shareMent')
        const kakaoButton = document.getElementById('kakaoButton')

        if (!verseButton || !verseBox || !verseText || !referenceText || !progressBar || !loadingText || !progressContainer) {
            console.error("필수 요소를 찾을 수 없습니다!");
            return;
        }

        document.getElementById("verseButton").addEventListener("click", () => {
            console.log("뽑기 버튼 클릭");

            const loadingText = document.getElementById("loadingText");

            // "말씀을 뽑고 있습니다..." 애니메이션 활성화
            loadingText.style.display = 'flex'
            // 5초 후 애니메이션 숨김
            setTimeout(() => {
                loadingText.classList.remove("active");
            }, 5000);

            const imageContainer = document.querySelector('.imageContainer');
            if (imageContainer) {
                imageContainer.style.display = "none";
            }

            // 버튼 텍스트 변경
            verseButton.innerText = "다시 뽑기";
            verseButton.style.fontSize = '16px'
            verseButton.style.marginTop = '15px'

            // 로딩 텍스트 및 게이지 바 활성화
            progressContainer.style.display = "block";
            progressBar.style.width = "0%";
            shareMent.style.display = 'none'
            verseBox.style.display = 'none'

            // 게이지 바 애니메이션 시작
            setTimeout(() => {
                progressBar.style.transition = "width 5s linear";
                progressBar.style.width = "100%";
            }, 10);

            // 5초 후 랜덤 말씀 표시 및 공유 버튼 활성화
            setTimeout(() => {
                const randomIndex = Math.floor(Math.random() * verses.length);
                const selectedVerse = verses[randomIndex];

                // 말씀과 참조 업데이트
                verseText.innerText = `"${selectedVerse.verse}"`;
                referenceText.innerText = selectedVerse.reference;

                // 로딩 텍스트 숨김 및 말씀 표시
                loadingText.style.display = "none";
                progressContainer.style.display = "none";
                progressBar.style.width = "0%";
                verseBox.style.display = 'block'

                // 카카오톡 공유 버튼 표시
                kakaoButton.style.display = "block";
                download.style.display = "block"
                download.style.margin = "23px 0"; // 다운로드 버튼 가운데 정렬
                download.style.textAlign = "center"; // 텍스트 정렬 보장
                download.style.fontSize = '18px'
                download.style.padding = "12px 16px"; // 패딩 상하: 12px, 좌우: 60px
                console.log("선택된 말씀:", selectedVerse);
            }, 5000); // 5초 딜레이
        });

        //사진 다운로드
        document.getElementById("downloadButton").addEventListener("click", () => {
            const container = document.querySelector(".container");
            const verseBox = document.getElementById("verseBox");
            const h1 = document.querySelector("h1");
            const h2 = document.querySelector("h2");

            // UI 요소 숨김 처리
            document.getElementById("verseButton").style.display = "none";
            document.getElementById("downloadButton").style.display = "none";
            const shareButton = document.getElementById("kakaoButton");
            if (shareButton) shareButton.style.display = "none";

            // 캡처 설정
            html2canvas(container, {
                useCORS: true,
                backgroundColor: "#fdf1f1", // 배경 색상
                onclone: (clonedDoc) => {
                    const clonedH1 = clonedDoc.querySelector("h1");
                    const clonedH2 = clonedDoc.querySelector("h2");
                    const clonedVerseBox = clonedDoc.getElementById("verseBox");

                    // 제목 (h1) 스타일 조정
                    clonedH1.style.fontSize = "4.5rem";
                    clonedH1.style.textAlign = "center";
                    clonedH1.style.marginBottom = "10px";
                    clonedH1.style.fontWeight = "bold";

                    // 배경색 없애기 및 텍스트 색상 설정
                    clonedH1.style.background = "none"; // 배경 제거
                    clonedH1.style.webkitBackgroundClip = "none"; // 배경 클립 제거
                    clonedH1.style.webkitTextFillColor = "inherit"; // 텍스트 채우기 원래 색상
                    clonedH1.style.color = "#b63e3e"; // 기존 글자 색상으로 설정

                    // 부제목 (h2) 스타일 조정
                    clonedH2.style.fontSize = "1.5rem";
                    clonedH2.style.textAlign = "center";
                    clonedH2.style.marginBottom = "15px";

                    // verse-box 스타일 조정
                    clonedVerseBox.style.padding = "30px";
                    clonedVerseBox.style.margin = "0 auto";
                    clonedVerseBox.style.boxShadow = "none"; // 캡처 시 그림자 제거
                    // 말씀 박스 (verse-box) 스타일 조정
                    clonedVerseBox.style.padding = "30px";
                    clonedVerseBox.style.margin = "0 auto";
                    clonedVerseBox.style.border = "1px solid #F5C2C2"; // 부드러운 테두리
                    clonedVerseBox.style.borderRadius = "15px";
                    clonedVerseBox.style.boxShadow = "none"; // 캡처 시 그림자 제거
                    clonedVerseBox.style.background = "white"; // 배경 흰색으로 유지
                },
            })
                .then((canvas) => {
                    // 캡처된 이미지를 Blob으로 변환 후 다운로드
                    canvas.toBlob((blob) => {
                        const link = document.createElement("a");
                        link.href = URL.createObjectURL(blob);
                        link.download = "bible-verse.png";
                        link.click();
                        URL.revokeObjectURL(link.href);

                        // UI 요소 복원
                        document.getElementById("verseButton").style.display = "block";
                        document.getElementById("downloadButton").style.display = "block";
                        if (shareButton) shareButton.style.display = "block";
                    });
                })
                .catch((err) => {
                    console.error("다운로드 중 오류 발생:", err);
                });
        });



        // 카카오 초기화
        Kakao.init('0288684a26b770807358f1c5e855b1c1');
        // 카카오톡 공유 기능
            document.getElementById("kakaoButton").addEventListener("click", () => {
                Kakao.Link.sendCustom({
                    templateId: 115764, // 생성한 템플릿 ID
                    templateArgs: {
                        // 동적으로 전달할 데이터 (템플릿 설정에서 정의한 값들)
                        title: '2025 내게 주신 하나님의 말씀', // 템플릿에 전달할 title
                        description: `제가 뽑은 말씀은 ${verse.innerText} (${reference.innerText}) 이에요!`,
                    }
                });
            });
    });
</script>
</body>
</html>
<!--인스타연동, 소리 넣기, 뽑기 글자 디자인변경, 다운(웹 가능), 파비콘 변경-->
